"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[229],{4095:function(e,i,t){t.d(i,{l:function(){return v}});var o=t(2903),n=t(221),a=t(6131),r=t(2784),l=t(3476),s=t(8512),d=t(5802),c=t(9120),u=t(9820),g=t(2400),m=t(9654);const p=e=>/^\S+@\S+\.\S+$/.test(e),v=e=>{const{onSuccess:i,onReset:t,resetButtonLabel:d}=e,{organization:m,invitations:v}=(0,a.o8)({invitations:{pageSize:10,keepPreviousData:!0}}),f=(0,s.useCardState)(),{t:z,locale:b,translateError:P}=(0,c.zJ)(),[Z,y]=(0,r.useState)(!1),S=(0,g.Yp)("emailAddress","",{type:"text",label:(0,c.u1)("formFieldLabel__emailAddresses")}),_=(0,g.Yp)("role","",{label:(0,c.u1)("formFieldLabel__role")});if(!m)return null;const{props:{setError:C,setWarning:x,setSuccess:K,setInfo:T,isFocused:B,validatePassword:R,setHasPassedComplexity:D,hasPassedComplexity:w,feedback:F,feedbackType:L,clearFeedback:$,...I}}=S,X=(!!S.value.length||Z)&&!!_.value;return(0,o.BX)(s.Form.Root,{onSubmit:e=>{if(e.preventDefault(),!X)return;const t=new FormData(e.currentTarget);return m.inviteMembers({emailAddresses:S.value.split(","),role:t.get("role")}).then((async()=>{var e;return await(null===(e=null==v?void 0:v.revalidate)||void 0===e?void 0:e.call(v)),null==i?void 0:i()})).catch((e=>{var i,t,o,a,r;if((0,n.kD)(e)&&(e=>{var i,t,o,n;const a=new Set([...null!==(t=null===(i=e.meta)||void 0===i?void 0:i.emailAddresses)&&void 0!==t?t:[],...null!==(n=null===(o=e.meta)||void 0===o?void 0:o.identifiers)&&void 0!==n?n:[]]),r=S.value.split(",");S.setValue(r.filter((e=>!a.has(e))).join(","))})(e.errors[0]),(0,n.kD)(e)&&"duplicate_record"===(null===(t=null===(i=e.errors)||void 0===i?void 0:i[0])||void 0===t?void 0:t.code)){const i=(null===(o=e.errors[0].meta)||void 0===o?void 0:o.emailAddresses)||[];f.setError(z((0,c.u1)("organizationProfile.invitePage.detailsTitle__inviteFailed",{email_addresses:(0,g.z$)(i,b)})))}else(0,n.kD)(e)&&"form_param_format_invalid"===(null===(r=null===(a=e.errors)||void 0===a?void 0:a[0])||void 0===r?void 0:r.code)?f.setError(P(e.errors[0])):(0,g.S3)(e,[],f.setError)}))},children:[(0,o.tZ)(s.Form.ControlRow,{elementId:S.id,children:(0,o.tZ)(s.TagInput,{...I,autoFocus:!0,validate:p,sx:{width:"100%"},validateUnsubmittedEmail:e=>y(p(e)),placeholder:(0,c.u1)("formFieldInputPlaceholder__emailAddresses")})}),(0,o.BX)(l.Flex,{align:"center",justify:"between",sx:e=>({marginTop:e.space.$2,gap:e.space.$4,flexWrap:"wrap",[u.mqu.sm]:{justifyContent:"center"}}),children:[(0,o.tZ)(h,{..._}),(0,o.BX)(s.FormButtonContainer,{sx:e=>({margin:e.space.$none,flexWrap:"wrap",justifyContent:"center"}),children:[(0,o.tZ)(s.Form.SubmitButton,{block:!1,isDisabled:!X,localizationKey:(0,c.u1)("organizationProfile.invitePage.formButtonPrimary__continue")}),(0,o.tZ)(s.Form.ResetButton,{localizationKey:d||(0,c.u1)("userProfile.formButtonReset"),block:!1,onClick:t})]})]})]})},h=e=>{const{options:i,isLoading:t}=(0,d.e)(),{t:n}=(0,c.zJ)();return(0,o.tZ)(s.Form.ControlRow,{elementId:e.id,children:(0,o.tZ)(l.Flex,{direction:"col",gap:2,children:(0,o.tZ)(m.DQ,{...e.props,roles:i,isDisabled:t,onChange:i=>e.setValue(i),triggerSx:e=>({minWidth:e.sizes.$40,justifyContent:"space-between",display:"flex"}),optionListSx:e=>({minWidth:e.sizes.$48}),prefixLocalizationKey:`${n((0,c.u1)("formFieldLabel__role"))}:`})})})}},5362:function(e,i,t){t.d(i,{a:function(){return h},N:function(){return v}});var o=t(2903),n=t(6131),a=t(2045),r=t(1940),l=t(3918),s=t(3476),d=t(8512),c=t(1671),u=t(7790),g=t(3736);const m=({__unstable_manageBillingUrl:e,__unstable_manageBillingMembersLimit:i})=>{const t=(0,g.useRouter)();return(0,o.BX)(s.Flex,{sx:e=>({background:e.colors.$neutralAlpha50,padding:e.space.$4,borderRadius:e.radii.$md}),children:[(0,o.tZ)(s.AlertIcon,{variant:"warning",colorScheme:"danger",sx:e=>({marginTop:e.space.$1})}),(0,o.BX)(s.Text,{children:["This organization is limited to ",(0,a.OR)(i)," members.",(0,o.tZ)("br",{}),(0,o.tZ)(s.Link,{sx:e=>({alignSelf:"flex-start",color:e.colors.$primary500,fontWeight:e.fontWeights.$normal}),onClick:()=>t.navigate((0,a.OR)(e)),children:"Upgrade for unlimited members"})]})]})};var p=t(4095);const v=(0,d.withCardStateProvider)((e=>{const{close:i}=(0,c.XC)(),{onReset:t=i}=e,u=(0,s.localizationKeys)("organizationProfile.invitePage.title"),g=(0,s.localizationKeys)("organizationProfile.invitePage.subtitle"),v=(0,d.useCardState)(),f=(0,r.a2)({onNextStep:()=>v.setError(void 0)}),{organization:z}=(0,n.o8)(),{__unstable_manageBillingUrl:b,__unstable_manageBillingMembersLimit:P}=(0,l.useOrganizationProfileContext)();if(!z)return null;const Z=!!P&&(0,a.OR)(P)<=z.pendingInvitationsCount+z.membersCount;return(0,o.BX)(r.en,{...f.props,children:[(0,o.BX)(d.FormContainer,{headerTitle:u,headerSubtitle:g,children:[Z&&b&&(0,o.tZ)(m,{__unstable_manageBillingUrl:b,__unstable_manageBillingMembersLimit:P}),(0,o.tZ)(p.l,{onSuccess:f.nextStep,onReset:t})]}),(0,o.tZ)(d.SuccessPage,{title:u,onFinish:i,contents:(0,o.tZ)(h,{})})]})})),h=()=>(0,o.BX)(s.Flex,{direction:"col",center:!0,gap:4,children:[(0,o.tZ)(d.IconCircle,{boxElementDescriptor:s.descriptors.invitationsSentIconBox,iconElementDescriptor:s.descriptors.invitationsSentIcon,icon:u.GT}),(0,o.tZ)(s.Text,{localizationKey:(0,s.localizationKeys)("organizationProfile.invitePage.successMessage")})]})},9654:function(e,i,t){t.d(i,{DQ:function(){return u},RN:function(){return c},wQ:function(){return s}});var o=t(2903),n=t(2784),a=t(3476),r=t(8512),l=t(5802);const s=e=>{const{headers:i,page:t,onPageChange:n,rows:l,isLoading:s,itemCount:c,itemsPerPage:u,pageCount:g,emptyStateLocalizationKey:m}=e,p=c>0?Math.max(0,(t-1)*u)+1:0,v=Math.min(t*u,c);return(0,o.BX)(a.Col,{gap:4,sx:{width:"100%"},children:[(0,o.tZ)(a.Flex,{sx:e=>({overflowX:"auto",padding:e.space.$1}),children:(0,o.BX)(a.Table,{children:[(0,o.tZ)(a.Thead,{children:(0,o.tZ)(a.Tr,{children:i.map(((e,i)=>(0,o.tZ)(a.Th,{elementDescriptor:a.descriptors.tableHead,localizationKey:e},i)))})}),(0,o.tZ)(a.Tbody,{children:s?(0,o.tZ)(a.Tr,{children:(0,o.tZ)(a.Td,{colSpan:4,children:(0,o.tZ)(a.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"},elementDescriptor:a.descriptors.spinner})})}):l.length?l:(0,o.tZ)(d,{localizationKey:m},"empty")})]})}),g>1&&(0,o.tZ)(r.Pagination,{count:g,page:t,onChange:n,siblingCount:1,rowInfo:{allRowsCount:c,startingRow:p,endingRow:v}})]})},d=e=>(0,o.tZ)(a.Tr,{children:(0,o.tZ)(a.Td,{colSpan:4,children:(0,o.tZ)(a.Text,{localizationKey:e.localizationKey,sx:{margin:"auto",display:"block",width:"fit-content"}})})}),c=e=>(0,o.tZ)(a.Tr,{...e,sx:e=>({":hover":{backgroundColor:e.colors.$neutralAlpha50}})}),u=e=>{const{value:i,roles:t,onChange:s,isDisabled:d,triggerSx:c,optionListSx:u,prefixLocalizationKey:m}=e,{localizeCustomRole:p}=(0,l.q)(),v=(0,n.useMemo)((()=>[...t||[]]),[t]),h=(0,n.useMemo)((()=>v.find((e=>e.value===i))),[v]),{t:f}=(0,a.useLocalizations)(),z=(0,n.useMemo)((()=>v.map((e=>({value:e.value,label:p(e.value)||e.label})))),[v,p]);return(0,o.BX)(r.Select,{elementId:"role",options:z,value:i,placeholder:f((0,a.localizationKeys)("organizationProfile.invitePage.selectDropdown__role")),onChange:e=>s(e.value),renderOption:(e,i,t)=>(0,o.tZ)(g,{isSelected:t,option:e,sx:e=>({"&:hover":{backgroundColor:e.colors.$neutralAlpha100},'&[data-focused="true"]':{backgroundColor:e.colors.$neutralAlpha150}})}),children:[(0,o.tZ)("input",{name:"role",type:"hidden",value:i}),(0,o.tZ)(r.SelectButton,{sx:c||(e=>({color:e.colors.$colorText,backgroundColor:"transparent",textWrap:"nowrap"})),isDisabled:d,children:((null==h?void 0:h.label)||(null==h?void 0:h.value))&&(0,o.BX)(a.Flex,{as:"span",gap:1,children:[m&&(0,o.tZ)(a.Text,{as:"span",colorScheme:"secondary",localizationKey:m}),(0,o.tZ)(a.Text,{as:"span",sx:e=>({color:e.colors.$colorText}),children:p(null==h?void 0:h.value)||(null==h?void 0:h.label)})]})}),(0,o.tZ)(r.SelectOptionList,{sx:u})]})},g=(0,n.memo)((e=>{const{option:i,isSelected:t,sx:n,...r}=e;return(0,o.tZ)(a.Flex,{sx:[e=>({width:"100%",padding:`${e.space.$2} ${e.space.$4}`,borderRadius:e.radii.$md}),n],...r,children:(0,o.tZ)(a.Text,{colorScheme:"secondary",children:null==i?void 0:i.label})})}))},6884:function(e,i,t){t.d(i,{D:function(){return l}});var o=t(2903),n=t(3476),a=t(8512),r=t(9120);const l=e=>{const{organization:i,...t}=e;return(0,o.BX)(n.Col,{children:[(0,o.tZ)(n.Text,{variant:"subtitle",sx:e=>({textAlign:"left",marginBottom:e.space.$2}),localizationKey:(0,r.u1)("organizationProfile.start.profileSection.uploadAction__title")}),(0,o.tZ)(a.AvatarUploader,{...t,title:(0,r.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,o.tZ)(a.OrganizationAvatar,{size:e=>e.sizes.$16,...i})})]})}},8472:function(e,i,t){t.r(i),t.d(i,{OrganizationProfile:function(){return he},OrganizationProfileModal:function(){return fe}});var o=t(2903),n=t(6131),a=t(2784),r=t(3918),l=t(3476),s=t(8512),d=t(3736),c=t(1940),u=t(8246),g=t(9120);const m=e=>{const{organization:i}=(0,n.o8)(),{pages:t}=(0,r.useOrganizationProfileContext)(),a=(0,c.N2)((e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"})));return i?(0,o.BX)(s.NavbarContextProvider,{children:[(0,o.tZ)(s.NavBar,{title:(0,g.u1)("organizationProfile.navbar.title"),description:(0,g.u1)("organizationProfile.navbar.description"),routes:t.routes.filter((e=>e.id!==u.b.MEMBERS||e.id===u.b.MEMBERS&&a)),contentRef:e.contentRef}),e.children]}):null};var p=t(3185),v=t(5235),h=t(1671),f=t(2400),z=t(1659);const b=e=>{const i=(0,s.useCardState)(),{navigateAfterLeaveOrganization:t}=(0,r.useOrganizationProfileContext)(),{userMemberships:o,userInvitations:a}=(0,n.eW)({userMemberships:z.AO.userMemberships,userInvitations:z.AO.userInvitations});return()=>i.runAsync((async()=>{await(null==e?void 0:e())})).then((()=>{var e,i;null===(e=o.revalidate)||void 0===e||e.call(o),null===(i=a.revalidate)||void 0===i||i.call(a),t()}))},P=e=>{const{organization:i}=(0,n.o8)(),{user:t}=(0,n.aF)(),a=b((()=>t.leaveOrganization(i.id)));return i&&t?(0,o.tZ)(y,{organizationName:null==i?void 0:i.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription",{organizationName:null==i?void 0:i.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.successMessage"),onConfirmation:a,...e}):null},Z=e=>{const{organization:i,membership:t}=(0,n.o8)(),a=b(null==i?void 0:i.destroy);return i&&t?(0,o.tZ)(y,{organizationName:null==i?void 0:i.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.actionDescription",{organizationName:null==i?void 0:i.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.successMessage"),onConfirmation:a,...e}):null},y=(0,s.withCardStateProvider)((e=>{const{title:i,messageLine1:t,messageLine2:n,actionDescription:a,organizationName:r,successMessage:d,submitLabel:u,onSuccess:g,onReset:m,onConfirmation:p,colorScheme:v="danger"}=e,h=(0,c.a2)(),z=(0,s.useCardState)(),b=(0,f.Yp)("deleteOrganizationConfirmation","",{type:"text",label:a||(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription"),isRequired:!0,placeholder:r}),P=!a||b.value===r;return(0,o.BX)(c.en,{...h.props,children:[(0,o.tZ)(s.FormContainer,{headerTitle:i,gap:1,children:(0,o.BX)(s.Form.Root,{onSubmit:async()=>{if(P)try{await p().then((()=>h.nextStep()))}catch(e){(0,f.S3)(e,[],z.setError)}},children:[(0,o.BX)(l.Col,{children:[(0,o.tZ)(l.Text,{localizationKey:t,colorScheme:"secondary"}),(0,o.tZ)(l.Text,{localizationKey:n,colorScheme:"danger"})]}),(0,o.tZ)(s.Form.ControlRow,{elementId:b.id,children:(0,o.tZ)(s.Form.PlainInput,{...b.props})}),(0,o.BX)(s.FormButtonContainer,{children:[(0,o.tZ)(s.Form.SubmitButton,{block:!1,colorScheme:v,localizationKey:u,isDisabled:!P}),(0,o.tZ)(s.Form.ResetButton,{localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:m})]})]})}),(0,o.tZ)(s.SuccessPage,{title:i,text:d,onFinish:g})]})}));var S=t(1661),_=t(7790);const C=(0,s.withCardStateProvider)((e=>{const{domainId:i,mode:t="edit",onSuccess:d,onReset:u}=e,g=(0,s.useCardState)(),{organizationSettings:m}=(0,r.useEnvironment)(),{membership:p,organization:v,domains:h}=(0,n.o8)({domains:{infinite:!0}}),z="edit"===t,b=(()=>{const{organizationSettings:e}=(0,r.useEnvironment)();return(e=>{const i=[];return e.domains.enrollmentModes.includes("manual_invitation")&&i.push({value:"manual_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__description")}),e.domains.enrollmentModes.includes("automatic_invitation")&&i.push({value:"automatic_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__description")}),e.domains.enrollmentModes.includes("automatic_suggestion")&&i.push({value:"automatic_suggestion",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__description")}),i})(e)})(),P=(0,f.Yp)("enrollmentMode","",{type:"radio",radioOptions:b,isRequired:!0}),Z=(0,f.Yp)("deleteExistingInvitationsSuggestions","",{label:(0,l.localizationKeys)("formFieldLabel__organizationDomainDeletePending"),type:"checkbox"}),{data:y,isLoading:C}=(0,S.ib)(null==v?void 0:v.getDomain,{domainId:i});(0,a.useEffect)((()=>{y&&P.setValue(y.enrollmentMode)}),[null==y?void 0:y.id]);const x=(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.title",{domain:null==y?void 0:y.name}),K=(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.subtitle",{domain:null==y?void 0:y.name}),T=((e,{infoLabel:i})=>{const t=(null==e?void 0:e.totalPendingInvitations)||0;return 0===((null==e?void 0:e.totalPendingSuggestions)||0)+t?[]:[i,(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInvitationCountLabel",{count:t}),(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutSuggestionCountLabel",{count:t})]})(y,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInfoLabel")});return v&&m?C||!y?(0,o.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:{height:"100%"},children:(0,o.tZ)(l.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})}):(y.verification&&"verified"===y.verification.status||u(),(0,o.tZ)(s.FormContainer,{headerTitle:x,headerSubtitle:z?void 0:K,gap:4,children:(0,o.BX)(l.Col,{gap:6,children:[T.length>0&&(0,o.tZ)(c.aX,{icon:_.I$,children:T.map(((e,i)=>(0,o.tZ)(l.Text,{as:"span",sx:{display:"block"},localizationKey:e},i)))}),(0,o.tZ)(s.Header.Root,{children:(0,o.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.subtitle"),variant:"subtitle"})}),(0,o.BX)(s.Form.Root,{onSubmit:async()=>{if(y&&v&&p&&h)try{await y.updateEnrollmentMode({enrollmentMode:P.value,deletePending:Z.checked}),await h.revalidate(),d()}catch(e){(0,f.S3)(e,[P],g.setError)}},gap:6,children:[(0,o.tZ)(s.Form.ControlRow,{elementId:P.id,children:(0,o.tZ)(s.Form.RadioGroup,{...P.props})}),z&&"manual_invitation"===P.value&&(0,o.tZ)(s.Form.ControlRow,{elementId:Z.id,children:(0,o.tZ)(s.Form.Checkbox,{...Z.props})}),(0,o.tZ)(s.FormButtons,{isDisabled:C||!y,onReset:u})]})]})})):null})),x=(0,s.withCardStateProvider)((e=>{var i;const{domainId:t,onSuccess:d,onReset:u,skipToVerified:g}=e,m=(0,s.useCardState)(),{organizationSettings:p}=(0,r.useEnvironment)(),{organization:v}=(0,n.o8)(),{data:h,isLoading:z}=(0,S.ib)(g||null==v?void 0:v.getDomain,{domainId:t}),b=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.title"),P=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitle",{domainName:null!==(i=null==h?void 0:h.name)&&void 0!==i?i:""}),Z=(0,c.a2)({defaultStep:g?2:0,onNextStep:()=>m.setError(void 0)}),y=(0,f.Yp)("affiliationEmailAddress","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddress"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomainEmailAddress"),infoText:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddressDescription"),isRequired:!0}),_=(0,a.useRef)(),x=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitleVerificationCodeScreen",{emailAddress:_.current}),K=(0,s.useFieldOTP)({onCodeEntryFinished:(e,i,t)=>{((e,i,t)=>{var o;null===(o=null==h?void 0:h.attemptAffiliationVerification)||void 0===o||o.call(h,{code:e}).then((async e=>{var t;await i(),"verified"===(null===(t=e.verification)||void 0===t?void 0:t.status)?Z.nextStep():null==d||d()})).catch((e=>t(e)))})(e,i,t)},onResendCodeClicked:()=>{null==h||h.prepareAffiliationVerification({affiliationEmailAddress:y.value}).catch((e=>{(0,f.S3)(e,[y],m.setError)}))}});if(!v||!p)return null;const T=v.name!==y.value,B=`@${null==h?void 0:h.name}`;return!z&&h||g?(0,o.BX)(c.en,{...Z.props,children:[(0,o.tZ)(s.FormContainer,{headerTitle:b,headerSubtitle:P,children:(0,o.BX)(s.Form.Root,{onSubmit:e=>{if(e.preventDefault(),h)return _.current=`${y.value}${B}`,h.prepareAffiliationVerification({affiliationEmailAddress:_.current}).then(Z.nextStep).catch((e=>{(0,f.S3)(e,[y],m.setError)}))},children:[(0,o.tZ)(s.Form.ControlRow,{elementId:y.id,children:(0,o.tZ)(s.Form.InputGroup,{...y.props,autoFocus:!0,groupSuffix:B,ignorePasswordManager:!0})}),(0,o.tZ)(s.FormButtons,{isDisabled:!T,onReset:u})]})}),(0,o.BX)(s.FormContainer,{headerTitle:b,headerSubtitle:x,children:[(0,o.tZ)(s.Form.OTPInput,{...K,label:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formTitle"),description:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formSubtitle"),resendButton:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.resendButton")}),(0,o.tZ)(s.FormButtonContainer,{children:(0,o.tZ)(l.Button,{elementDescriptor:l.descriptors.formButtonReset,block:!1,variant:"ghost",textVariant:"buttonSmall",type:"reset",isDisabled:K.isLoading||"success"===K.otpControl.otpInputProps.feedbackType,onClick:()=>{K.otpControl.otpInputProps.clearFeedback(),K.otpControl.reset(),Z.prevStep()},localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset")})})]}),(0,o.tZ)(C,{domainId:t,mode:"select",onSuccess:d,onReset:u})]}):(0,o.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",children:(0,o.tZ)(l.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})})})),K=(0,s.withCardStateProvider)((e=>{const{onSuccess:i,onReset:t}=e,{organizationSettings:d}=(0,r.useEnvironment)(),{domains:u}=(0,n.o8)({domains:{infinite:!0}}),g=(0,c.a2)({onNextStep:()=>P.setError(void 0)}),[m,p]=(0,a.useState)(""),[v,h]=(0,a.useState)(!1),z=(0,l.localizationKeys)("organizationProfile.createDomainPage.title"),b=(0,l.localizationKeys)("organizationProfile.createDomainPage.subtitle"),P=(0,s.useCardState)(),{organization:Z}=(0,n.o8)(),y=(0,f.Yp)("name","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomain"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomain")});if(!Z||!d)return null;const S=""!==y.value.trim();return(0,o.BX)(c.en,{...g.props,children:[(0,o.tZ)(s.FormContainer,{headerTitle:z,headerSubtitle:b,children:(0,o.BX)(s.Form.Root,{onSubmit:e=>(y.clearFeedback(),e.preventDefault(),Z.createDomain(y.value).then((async e=>{var i;p(e.id),null===(i=null==u?void 0:u.revalidate)||void 0===i||i.call(u),e.verification&&"verified"===e.verification.status&&h(!0),g.nextStep()})).catch((e=>{(0,f.S3)(e,[y],P.setError)}))),children:[(0,o.tZ)(s.Form.ControlRow,{elementId:y.id,children:(0,o.tZ)(s.Form.PlainInput,{...y.props,autoFocus:!0,ignorePasswordManager:!0,isRequired:!0})}),(0,o.tZ)(s.FormButtons,{isDisabled:!S,onReset:t})]})}),(0,o.tZ)(x,{domainId:m,onSuccess:()=>{var e;null===(e=null==u?void 0:u.revalidate)||void 0===e||e.call(u),null==i||i()},skipToVerified:v,onReset:t})]})})),T={manual_invitation:(0,l.localizationKeys)("organizationProfile.badge__manualInvitation"),automatic_invitation:(0,l.localizationKeys)("organizationProfile.badge__automaticInvitation"),automatic_suggestion:(0,l.localizationKeys)("organizationProfile.badge__automaticSuggestion")},B=e=>{const{organizationDomain:i}=e;return i?i.verification&&"verified"===i.verification.status?(0,o.tZ)(l.Badge,{localizationKey:T[i.enrollmentMode],colorScheme:"manual_invitation"===i.enrollmentMode?"primary":"success"}):(0,o.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("organizationProfile.badge__unverified"),colorScheme:"warning"}):null},R=e=>{var i;const{organizationSettings:t}=(0,r.useEnvironment)(),{organization:s}=(0,n.o8)(),{domainId:d,onSuccess:u,onReset:m}=e,p=a.useRef(),{data:v,isLoading:h}=(0,S.ib)(null==s?void 0:s.getDomain,{domainId:d},{onSuccess(e){p.current={...e}}}),{domains:f}=(0,n.o8)({domains:{infinite:!0}});return s&&t?h||!v?(0,o.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",children:(0,o.tZ)(l.Spinner,{size:"lg",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})}):(0,o.tZ)(c.LE,{title:(0,g.u1)("organizationProfile.removeDomainPage.title"),messageLine1:(0,g.u1)("organizationProfile.removeDomainPage.messageLine1",{domain:null===(i=p.current)||void 0===i?void 0:i.name}),messageLine2:(0,g.u1)("organizationProfile.removeDomainPage.messageLine2"),deleteResource:()=>null==v?void 0:v.delete().then((async()=>{var e;await(null===(e=null==f?void 0:f.revalidate)||void 0===e?void 0:e.call(f)),u()})),onSuccess:u,onReset:m}):null},D=e=>{const{close:i}=(0,h.XC)();return(0,o.tZ)(R,{onSuccess:i,onReset:i,...e})},w=e=>{const{close:i}=(0,h.XC)();return(0,o.tZ)(C,{onSuccess:i,onReset:i,...e})},F=e=>{const{close:i}=(0,h.XC)();return(0,o.tZ)(x,{onSuccess:i,onReset:i,skipToVerified:!1,...e})},L=({domain:e})=>{const i=(e=>{const{open:i}=(0,h.XC)(),t=[];return e.verification&&"verified"===e.verification.status?t.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.menuAction__manage"),onClick:()=>i("manage")}):t.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.menuAction__verify"),onClick:()=>i("verify")}),t.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.menuAction__remove"),isDestructive:!0,onClick:()=>i("remove")}),t})(e);return(0,o.tZ)(s.ThreeDotsMenu,{actions:i})},$=(0,c.Ci)((e=>{const{verificationStatus:i,enrollmentMode:t,fallback:r,...d}=e,{organization:u,domains:g}=(0,n.o8)({domains:{infinite:!0,...d}}),{ref:m}=(0,S.YD)({threshold:0,onChange:e=>{var i;e&&(null===(i=null==g?void 0:g.fetchNext)||void 0===i||i.call(g))}}),p=(0,a.useMemo)((()=>(null==g?void 0:g.data)?g.data.filter((e=>{let o=!0,n=!0;return i&&(o=!!e.verification&&e.verification.status===i),t&&(n=e.enrollmentMode===t),o&&n})):[]),[null==g?void 0:g.data]);if(!u)return null;const h=(null==g?void 0:g.hasNextPage)||(null==g?void 0:g.isFetching);return 0!==p.length||(null==g?void 0:g.isLoading)||r?(0,o.BX)(s.ProfileSection.ItemList,{id:"organizationDomains",children:[0===p.length&&!(null==g?void 0:g.isLoading)&&r,p.map((e=>(0,o.BX)(v.a.Root,{children:[(0,o.BX)(s.ProfileSection.Item,{id:"organizationDomains",hoverable:!0,children:[(0,o.BX)(l.Flex,{sx:e=>({gap:e.space.$1}),children:[(0,o.tZ)(l.Text,{children:e.name}),(0,o.tZ)(B,{organizationDomain:e})]}),(0,o.tZ)(c.Cv,{permission:"org:sys_domains:manage",children:(0,o.tZ)(L,{domain:e})})]}),(0,o.tZ)(v.a.Open,{value:"remove",children:(0,o.tZ)(v.a.Card,{variant:"destructive",children:(0,o.tZ)(D,{domainId:e.id})})}),(0,o.tZ)(v.a.Open,{value:"verify",children:(0,o.tZ)(v.a.Card,{children:(0,o.tZ)(F,{domainId:e.id})})}),(0,o.tZ)(v.a.Open,{value:"manage",children:(0,o.tZ)(v.a.Card,{children:(0,o.tZ)(w,{domainId:e.id})})})]},e.id))),(0,o.tZ)(l.Box,{ref:(null==g?void 0:g.hasNextPage)&&!g.isFetching?m:void 0,sx:{visibility:"hidden"}}),h&&0===g.data.length&&(0,o.tZ)(l.Box,{sx:[e=>({width:"100%",height:e.space.$10,position:"relative"})],children:(0,o.tZ)(l.Box,{sx:{display:"flex",margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,o.tZ)(l.Spinner,{size:"sm",colorScheme:"primary",elementDescriptor:l.descriptors.spinner})})})]}):null}),{permission:"org:sys_domains:read"});var I=t(2045),X=t(6884);const k=(0,s.withCardStateProvider)((e=>{const{onSuccess:i,onReset:t}=e,a=(0,l.localizationKeys)("organizationProfile.profilePage.title"),r=(0,s.useCardState)(),{organization:d}=(0,n.o8)(),c=(0,f.Yp)("name",(null==d?void 0:d.name)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationName")}),u=(0,f.Yp)("slug",(null==d?void 0:d.slug)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationSlug"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationSlug")});if(!d)return null;const g=(d.name!==c.value||d.slug!==u.value)&&"error"!==u.feedbackType;return(0,o.tZ)(s.FormContainer,{headerTitle:a,children:(0,o.BX)(s.Form.Root,{onSubmit:async e=>(e.preventDefault(),(g?d.update({name:c.value,slug:u.value}):Promise.resolve()).then(i).catch((e=>{(0,f.S3)(e,[c,u],r.setError)}))),children:[(0,o.tZ)(X.D,{organization:d,onAvatarChange:e=>d.setLogo({file:e}).then((()=>{r.setIdle()})).catch((e=>(0,f.S3)(e,[],r.setError))),onAvatarRemove:(0,I.QO)(d.imageUrl)?null:()=>{d.setLogo({file:null}).then((()=>{r.setIdle()})).catch((e=>(0,f.S3)(e,[],r.setError)))}}),(0,o.tZ)(s.Form.ControlRow,{elementId:c.id,children:(0,o.tZ)(s.Form.PlainInput,{...c.props,autoFocus:!0,isRequired:!0,ignorePasswordManager:!0})}),(0,o.tZ)(s.Form.ControlRow,{elementId:u.id,children:(0,o.tZ)(s.Form.PlainInput,{...u.props,onChange:e=>{var i;i=e.target.value,u.setValue(i),u.clearFeedback()},ignorePasswordManager:!0})}),(0,o.tZ)(s.FormButtons,{isDisabled:!g,onReset:t})]})})})),M=()=>{const{close:e}=(0,h.XC)();return(0,o.tZ)(k,{onSuccess:e,onReset:e})},A=()=>{const{close:e}=(0,h.XC)();return(0,o.tZ)(K,{onSuccess:e,onReset:e})},O=()=>{const{close:e}=(0,h.XC)();return(0,o.tZ)(P,{onSuccess:e,onReset:e})},E=()=>{const{close:e}=(0,h.XC)();return(0,o.tZ)(Z,{onSuccess:e,onReset:e})},q=()=>(0,o.tZ)(l.Col,{elementDescriptor:l.descriptors.page,sx:e=>({gap:e.space.$8}),children:(0,o.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationGeneral"),children:[(0,o.tZ)(s.Header.Root,{children:(0,o.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__general"),sx:e=>({marginBottom:e.space.$4}),textVariant:"h2"})}),(0,o.tZ)(N,{}),(0,o.tZ)(c.Cv,{permission:"org:sys_domains:read",children:(0,o.tZ)(H,{})}),(0,o.tZ)(V,{}),(0,o.tZ)(j,{})]})}),N=()=>{const{organization:e}=(0,n.o8)();if(!e)return null;const i=(0,o.tZ)(s.OrganizationPreview,{size:"lg",mainIdentifierVariant:"subtitle",organization:e});return(0,o.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("organizationProfile.start.profileSection.title"),id:"organizationProfile",children:(0,o.BX)(v.a.Root,{children:[(0,o.tZ)(c.Cv,{permission:"org:sys_profile:manage",fallback:i,children:(0,o.tZ)(v.a.Closed,{value:"edit",children:(0,o.BX)(s.ProfileSection.Item,{id:"organizationProfile",children:[i,(0,o.tZ)(v.a.Trigger,{value:"edit",children:(0,o.tZ)(s.ProfileSection.Button,{id:"organizationProfile",localizationKey:(0,l.localizationKeys)("organizationProfile.start.profileSection.primaryButton")})})]})})}),(0,o.tZ)(v.a.Open,{value:"edit",children:(0,o.tZ)(v.a.Card,{children:(0,o.tZ)(M,{})})})]})})},H=()=>{const{organizationSettings:e}=(0,r.useEnvironment)(),{organization:i}=(0,n.o8)();return e&&i&&e.domains.enabled?(0,o.tZ)(s.ProfileSection.Root,{title:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),id:"organizationDomains",centered:!1,children:(0,o.BX)(v.a.Root,{children:[(0,o.tZ)($,{}),(0,o.BX)(c.Cv,{permission:"org:sys_domains:manage",children:[(0,o.tZ)(v.a.Trigger,{value:"add",children:(0,o.BX)(l.Col,{children:[(0,o.tZ)(s.ProfileSection.ArrowButton,{localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.primaryButton"),id:"organizationDomains"}),(0,o.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.subtitle"),sx:e=>({paddingLeft:e.space.$9}),colorScheme:"secondary"})]})}),(0,o.tZ)(v.a.Open,{value:"add",children:(0,o.tZ)(v.a.Card,{children:(0,o.tZ)(A,{})})})]})]})}):null},V=()=>{const{organization:e}=(0,n.o8)();return e?(0,o.tZ)(s.ProfileSection.Root,{id:"organizationDanger",title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),children:(0,o.BX)(v.a.Root,{children:[(0,o.tZ)(v.a.Closed,{value:"leave",children:(0,o.tZ)(s.ProfileSection.Item,{sx:e=>({paddingTop:0,paddingBottom:0,paddingLeft:e.space.$1}),id:"organizationDanger",children:(0,o.tZ)(v.a.Trigger,{value:"leave",children:(0,o.tZ)(s.ProfileSection.Button,{id:"organizationDanger",variant:"ghost",colorScheme:"danger",textVariant:"buttonLarge",localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title")})})})}),(0,o.tZ)(v.a.Open,{value:"leave",children:(0,o.tZ)(v.a.Card,{variant:"destructive",children:(0,o.tZ)(O,{})})})]})}):null},j=()=>{const{organization:e}=(0,n.o8)(),i=(0,c.N2)({permission:"org:sys_profile:delete"});if(!e)return null;const t=e.adminDeleteEnabled;return i&&t?(0,o.tZ)(s.ProfileSection.Root,{id:"organizationDanger",title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),sx:e=>({marginBottom:e.space.$4}),children:(0,o.BX)(v.a.Root,{children:[(0,o.tZ)(v.a.Closed,{value:"delete",children:(0,o.tZ)(s.ProfileSection.Item,{sx:e=>({paddingTop:0,paddingBottom:0,paddingLeft:e.space.$1}),id:"organizationDanger",children:(0,o.tZ)(v.a.Trigger,{value:"delete",children:(0,o.tZ)(s.ProfileSection.Button,{id:"organizationDanger",variant:"ghost",colorScheme:"danger",textVariant:"buttonLarge",localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title")})})})}),(0,o.tZ)(v.a.Open,{value:"delete",children:(0,o.tZ)(v.a.Card,{variant:"destructive",children:(0,o.tZ)(E,{})})})]})}):null};var U=t(9820),W=t(9813),Y=t(5802),G=t(9654);const Q={memberships:{pageSize:10,keepPreviousData:!0}},J=()=>{const e=(0,s.useCardState)(),{organization:i,memberships:t}=(0,n.o8)(Q),{options:a,isLoading:r}=(0,Y.e)();if(!i)return null;const d=i=>async()=>e.runAsync((async()=>{var e;const o=await i.destroy();return await(null===(e=null==t?void 0:t.revalidate)||void 0===e?void 0:e.call(t)),o})).catch((i=>(0,f.S3)(i,[],e.setError)));return(0,o.tZ)(G.wQ,{page:(null==t?void 0:t.page)||1,onPageChange:e=>{var i;return null===(i=null==t?void 0:t.fetchPage)||void 0===i?void 0:i.call(t,e)},itemCount:(null==t?void 0:t.count)||0,pageCount:(null==t?void 0:t.pageCount)||0,itemsPerPage:Q.memberships.pageSize,isLoading:(null==t?void 0:t.isLoading)||r,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.detailsTitle__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__joined"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==t?void 0:t.data)||[]).map((i=>{return(0,o.tZ)(ee,{membership:i,options:a,onRoleChange:(t=i,i=>e.runAsync((()=>t.update({role:i}))).catch((i=>(0,f.S3)(i,[],e.setError)))),onRemove:d(i)},i.id);var t}))})},ee=e=>{var i;const{membership:t,onRemove:a,onRoleChange:r,options:d}=e,{localizeCustomRole:c}=(0,Y.q)(),u=(0,s.useCardState)(),{user:g}=(0,n.aF)(),m=(null==g?void 0:g.id)===t.publicUserData.userId,p=null===(i=null==d?void 0:d.find((e=>e.value===t.role)))||void 0===i?void 0:i.label;return(0,o.BX)(G.RN,{children:[(0,o.tZ)(l.Td,{children:(0,o.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:t.publicUserData,subtitle:t.publicUserData.identifier,badge:m&&(0,o.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("badge__you")})})}),(0,o.tZ)(l.Td,{children:t.createdAt.toLocaleDateString()}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(W.Cv,{permission:"org:sys_memberships:manage",fallback:(0,o.tZ)(l.Text,{sx:e=>({opacity:e.opacity.$inactive}),children:c(t.role)||p}),children:(0,o.tZ)(G.DQ,{isDisabled:u.isLoading||!r,value:t.role,onChange:r,roles:d})})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(W.Cv,{permission:"org:sys_memberships:manage",children:(0,o.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.menuAction__remove"),isDestructive:!0,onClick:a,isDisabled:m}],elementId:"member"})})})]})};var ie=t(5362);const te=()=>{const e=(0,c.N2)({permission:"org:sys_memberships:manage"});return(0,o.BX)(v.a.Root,{animate:!1,children:[(0,o.tZ)(s.Animated,{asChild:!0,children:(0,o.tZ)(l.Flex,{justify:"end",sx:e=>({width:"100%",marginLeft:"auto",padding:`${e.space.$none} ${e.space.$1}`}),children:e&&(0,o.tZ)(v.a.Trigger,{value:"invite",children:(0,o.tZ)(l.Button,{elementDescriptor:l.descriptors.membersPageInviteButton,"aria-label":"Invite",textVariant:"buttonSmall",localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.action__invite")})})})}),e&&(0,o.tZ)(s.Animated,{children:(0,o.tZ)(v.a.Open,{value:"invite",children:(0,o.tZ)(l.Flex,{sx:e=>({paddingBottom:e.space.$6,padding:`${e.space.$none} ${e.space.$1} ${e.space.$6} ${e.space.$1}`}),children:(0,o.tZ)(v.a.Card,{sx:{width:"100%"},children:(0,o.tZ)(ie.N,{})})})})})]})},oe=()=>{const{organization:e}=(0,n.o8)(),{__unstable_manageBillingUrl:i,__unstable_manageBillingLabel:t,__unstable_manageBillingMembersLimit:a}=(0,r.useOrganizationProfileContext)(),c=(0,d.useRouter)();if(!e)return null;const u=(null==e?void 0:e.membersCount)+(null==e?void 0:e.pendingInvitationsCount),g=(0,I.OR)(a);return(0,o.tZ)(l.Flex,{sx:e=>({background:e.colors.$neutralAlpha50,padding:e.space.$2,borderRadius:e.radii.$md,gap:e.space.$4}),children:(0,o.BX)(l.Flex,{align:"center",sx:e=>({[U.mqu.sm]:{gap:e.space.$3},gap:e.space.$2}),children:[g>0&&(0,o.tZ)(s.Gauge,{limit:g,value:u,size:"xs"}),(0,o.BX)(l.Flex,{sx:e=>({[U.mqu.sm]:{flexDirection:"column"},gap:e.space.$0x5}),children:[(0,o.BX)(l.Text,{children:["You can invite ",a?`up to ${g}`:"unlimited"," members."]}),g>0&&(0,o.BX)(l.Link,{sx:e=>({fontWeight:e.fontWeights.$medium}),variant:"body",onClick:()=>c.navigate((0,I.OR)(i)),children:[(0,I.OR)(t)||"Manage billing",(0,o.tZ)(l.Icon,{icon:_.LZ})]})]})]})})},ne={invitations:{pageSize:10,keepPreviousData:!0}},ae=()=>{const e=(0,s.useCardState)(),{organization:i,invitations:t}=(0,n.o8)(ne),{options:a,isLoading:r}=(0,Y.e)();return i?(0,o.tZ)(G.wQ,{page:(null==t?void 0:t.page)||1,onPageChange:(null==t?void 0:t.fetchPage)||(()=>null),itemCount:(null==t?void 0:t.count)||0,pageCount:(null==t?void 0:t.pageCount)||0,itemsPerPage:ne.invitations.pageSize,isLoading:(null==t?void 0:t.isLoading)||r,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.tableHeader__invited"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==t?void 0:t.data)||[]).map((i=>{return(0,o.tZ)(re,{options:a,invitation:i,onRevoke:(n=i,async()=>e.runAsync((async()=>{var e;return await n.revoke(),await(null===(e=null==t?void 0:t.revalidate)||void 0===e?void 0:e.call(t)),n})).catch((i=>(0,f.S3)(i,[],e.setError))))},i.id);var n}))}):null},re=e=>{var i;const{invitation:t,onRevoke:n,options:a}=e,{localizeCustomRole:r}=(0,Y.q)(),d=null===(i=null==a?void 0:a.find((e=>e.value===t.role)))||void 0===i?void 0:i.label;return(0,o.BX)(G.RN,{children:[(0,o.tZ)(l.Td,{children:(0,o.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:{primaryEmailAddress:{emailAddress:t.emailAddress}}})}),(0,o.tZ)(l.Td,{children:t.createdAt.toLocaleDateString()}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(l.Text,{colorScheme:"secondary",localizationKey:r(t.role)||d})}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.menuAction__revoke"),isDestructive:!0,onClick:n}],elementId:"invitation"})})]})},le=(0,s.withCardStateProvider)((()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{__unstable_manageBillingUrl:t,navigateToGeneralPageRoot:n}=(0,r.useOrganizationProfileContext)(),a=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,o.BX)(l.Col,{gap:4,sx:{width:"100%"},children:[t&&(0,o.tZ)(oe,{}),a&&(0,o.tZ)(c.Cv,{permission:"org:sys_domains:manage",children:(0,o.BX)(l.Flex,{sx:e=>({width:"100%",gap:e.space.$8,paddingBottom:e.space.$4,paddingLeft:e.space.$1,paddingRight:e.space.$1,borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,[U.mqu.md]:{flexDirection:"column",gap:e.space.$2}}),children:[(0,o.tZ)(l.Col,{sx:e=>({width:e.space.$66,marginTop:e.space.$2}),children:(0,o.tZ)(s.Header.Root,{children:(0,o.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerTitle"),textVariant:"h3"})})}),(0,o.tZ)(l.Col,{sx:{width:"100%"},children:(0,o.tZ)($,{fallback:(0,o.BX)(o.HY,{children:[(0,o.tZ)(s.ProfileSection.ArrowButton,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.primaryButton"),id:"manageVerifiedDomains",sx:e=>({gap:e.space.$2}),onClick:n}),(0,o.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerSubtitle"),sx:e=>({paddingLeft:e.space.$10,color:e.colors.$colorTextSecondary,[U.mqu.md]:{paddingLeft:0}})})]}),verificationStatus:"verified",enrollmentMode:"automatic_invitation"})})]})}),(0,o.BX)(l.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,o.tZ)(te,{}),(0,o.tZ)(ae,{})]})]})})),se={membershipRequests:{pageSize:10,keepPreviousData:!0}},de=()=>{var e;const i=(0,s.useCardState)(),{organization:t,membershipRequests:a}=(0,n.o8)(se);return t?(0,o.tZ)(G.wQ,{page:(null==a?void 0:a.page)||1,onPageChange:null!==(e=null==a?void 0:a.fetchPage)&&void 0!==e?e:()=>null,itemCount:(null==a?void 0:a.count)||0,pageCount:(null==a?void 0:a.pageCount)||0,itemsPerPage:se.membershipRequests.pageSize,isLoading:null==a?void 0:a.isLoading,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.tableHeader__requested"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==a?void 0:a.data)||[]).map((e=>(0,o.tZ)(ce,{request:e,onError:i.setError},e.id)))}):null},ce=(0,s.withCardStateProvider)((e=>{const{request:i,onError:t}=e,a=(0,s.useCardState)(),{membership:r,membershipRequests:d}=(0,n.o8)(se);return(0,o.BX)(G.RN,{children:[(0,o.tZ)(l.Td,{children:(0,o.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},showAvatar:!1,user:{primaryEmailAddress:{emailAddress:i.publicUserData.identifier}}})}),(0,o.tZ)(l.Td,{children:i.createdAt.toLocaleDateString()}),(0,o.tZ)(l.Td,{children:(0,o.tZ)(ue,{onAccept:()=>{if(r&&d)return a.runAsync((async()=>{await i.accept(),await d.revalidate()}),"accept").catch((e=>(0,f.S3)(e,[],t)))},onReject:()=>{if(r&&d)return a.runAsync((async()=>{await i.reject(),await d.revalidate()}),"reject").catch((e=>(0,f.S3)(e,[],t)))}})})]})})),ue=e=>{const i=(0,s.useCardState)();return(0,o.BX)(l.Flex,{gap:2,children:[(0,o.tZ)(l.Button,{textVariant:"buttonSmall",variant:"ghost",isLoading:i.isLoading&&"reject"===i.loadingMetadata,isDisabled:i.isLoading&&"reject"!==i.loadingMetadata,onClick:e.onReject,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__reject")}),(0,o.tZ)(l.Button,{textVariant:"buttonSmall",isLoading:i.isLoading&&"accept"===i.loadingMetadata,isDisabled:i.isLoading&&"accept"!==i.loadingMetadata,onClick:e.onAccept,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__approve")})]})},ge=()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{__unstable_manageBillingUrl:t,navigateToGeneralPageRoot:n}=(0,r.useOrganizationProfileContext)(),a=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,o.BX)(l.Col,{gap:4,sx:{width:"100%"},children:[t&&(0,o.tZ)(oe,{}),a&&(0,o.tZ)(c.Cv,{permission:"org:sys_domains:manage",children:(0,o.BX)(l.Flex,{sx:e=>({width:"100%",gap:e.space.$8,paddingBottom:e.space.$4,paddingLeft:e.space.$1,paddingRight:e.space.$1,borderBottomWidth:e.borderWidths.$normal,borderBottomStyle:e.borderStyles.$solid,borderBottomColor:e.colors.$neutralAlpha100,[U.mqu.md]:{flexDirection:"column",gap:e.space.$2}}),children:[(0,o.tZ)(l.Col,{sx:e=>({width:e.space.$66,marginTop:e.space.$2}),children:(0,o.tZ)(s.Header.Root,{children:(0,o.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerTitle"),textVariant:"h3"})})}),(0,o.tZ)(l.Col,{sx:{width:"100%"},children:(0,o.tZ)($,{fallback:(0,o.BX)(o.HY,{children:[(0,o.tZ)(s.ProfileSection.ArrowButton,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.primaryButton"),sx:e=>({gap:e.space.$2}),id:"manageVerifiedDomains",onClick:n}),(0,o.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerSubtitle"),sx:e=>({paddingLeft:e.space.$10,color:e.colors.$colorTextSecondary,[U.mqu.md]:{paddingLeft:0}})})]}),verificationStatus:"verified",enrollmentMode:"automatic_suggestion"})})]})}),(0,o.BX)(l.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,o.tZ)(te,{}),(0,o.tZ)(de,{})]})]})},me=(0,s.withCardStateProvider)((()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),t=(0,s.useCardState)(),a=(0,c.N2)({permission:"org:sys_memberships:manage"}),d=(0,c.N2)({permission:"org:sys_memberships:read"}),u=(null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled)&&a,{membershipRequests:g,memberships:m,invitations:p}=(0,n.o8)({membershipRequests:u||void 0,invitations:a||void 0,memberships:d||void 0}),{__unstable_manageBillingUrl:h}=(0,r.useOrganizationProfileContext)();return null===a?null:(0,o.tZ)(l.Col,{elementDescriptor:l.descriptors.page,gap:2,children:(0,o.tZ)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationMembers"),gap:4,children:(0,o.BX)(v.a.Root,{animate:!1,children:[(0,o.tZ)(s.Animated,{asChild:!0,children:(0,o.tZ)(s.Header.Root,{contentSx:{[U.mqu.md]:{flexDirection:"row",width:"100%",justifyContent:"space-between"}},children:(0,o.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__members"),textVariant:"h2"})})}),(0,o.tZ)(s.Card.Alert,{children:t.error}),(0,o.BX)(s.Tabs,{children:[(0,o.BX)(s.TabsList,{sx:e=>({gap:e.space.$2}),children:[d&&(0,o.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__members"),children:(null==m?void 0:m.data)&&!m.isLoading&&(0,o.tZ)(c.dN,{notificationCount:m.count,colorScheme:"outline"})}),a&&(0,o.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__invitations"),children:(null==p?void 0:p.data)&&!p.isLoading&&(0,o.tZ)(c.dN,{notificationCount:p.count,colorScheme:"outline"})}),a&&u&&(0,o.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__requests"),children:(null==g?void 0:g.data)&&!g.isLoading&&(0,o.tZ)(c.dN,{notificationCount:g.count,colorScheme:"outline"})})]}),(0,o.BX)(s.TabPanels,{children:[d&&(0,o.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,o.BX)(l.Flex,{gap:4,direction:"col",sx:{width:"100%"},children:[a&&h&&(0,o.tZ)(oe,{}),(0,o.BX)(l.Flex,{gap:2,direction:"col",sx:{width:"100%"},children:[(0,o.tZ)(te,{}),(0,o.tZ)(J,{})]})]})}),a&&(0,o.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,o.tZ)(le,{})}),a&&u&&(0,o.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,o.tZ)(ge,{})})]})]})]})})})})),pe=()=>{var e;const{pages:i,isMembersPageRoot:t,isGeneralPageRoot:n}=(0,r.useOrganizationProfileContext)(),a=null===(e=i.contents)||void 0===e?void 0:e.map(((e,i)=>{const a=!n&&!t&&0===i;return(0,o.tZ)(d.Route,{index:a,path:a?void 0:e.url,children:(0,o.tZ)(p.O,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)}));return(0,o.BX)(d.Switch,{children:[a,(0,o.BX)(d.Route,{children:[(0,o.tZ)(d.Route,{path:n?void 0:"organization-general",children:(0,o.tZ)(d.Switch,{children:(0,o.tZ)(d.Route,{index:!0,children:(0,o.tZ)(q,{})})})}),(0,o.tZ)(d.Route,{path:t?void 0:"organization-members",children:(0,o.tZ)(d.Switch,{children:(0,o.tZ)(d.Route,{index:!0,children:(0,o.tZ)(c.Cv,{condition:e=>e({permission:"org:sys_memberships:read"})||e({permission:"org:sys_memberships:manage"}),redirectTo:n?"../":"./organization-general",children:(0,o.tZ)(me,{})})})})})]})]})},ve=(0,r.withCoreUserGuard)((()=>{const e=a.useRef(null);return(0,o.tZ)(s.ProfileCard.Root,{sx:e=>({display:"grid",gridTemplateColumns:"1fr 3fr",height:e.sizes.$176,overflow:"hidden"}),children:(0,o.BX)(m,{contentRef:e,children:[(0,o.tZ)(s.NavbarMenuButtonRow,{navbarTitleLocalizationKey:(0,l.localizationKeys)("organizationProfile.navbar.title")}),(0,o.tZ)(s.ProfileCard.Content,{contentRef:e,children:(0,o.tZ)(pe,{})})]})})})),he=(0,s.withCardStateProvider)((e=>{const{organization:i}=(0,n.o8)();return i?(0,o.tZ)(l.Flow.Root,{flow:"organizationProfile",children:(0,o.tZ)(l.Flow.Part,{children:(0,o.tZ)(d.Switch,{children:(0,o.tZ)(d.Route,{children:(0,o.tZ)(ve,{})})})})}):null})),fe=e=>{const i={...e,routing:"virtual",componentName:"OrganizationProfile",mode:"modal"};return(0,o.tZ)(d.Route,{path:"organizationProfile",children:(0,o.tZ)(r.ComponentContext.Provider,{value:i,children:(0,o.tZ)("div",{children:(0,o.tZ)(he,{...i})})})})}},1659:function(e,i,t){t.d(i,{AO:function(){return o},Sz:function(){return n}});const o={userMemberships:{infinite:!0},userInvitations:{infinite:!0},userSuggestions:{infinite:!0,status:["pending","accepted"]}},n=(e,i,t)=>{var o;if(void 0===i)return[{data:[e],total_count:1}];const n=(null===(o=null==i?void 0:i[i.length-1])||void 0===o?void 0:o.total_count)||1;return i.map((i=>{if(void 0===i)return i;const o=i.data.map((i=>i.id===e.id?{...e}:i));return{...i,data:o,total_count:"negative"===t?n-1:n}}))}}}]);